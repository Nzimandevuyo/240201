<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>R Code Homepage</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
    background-color: #f9f9f9;
    color: #222;
  }
  h1, h2, h3 {
    color: #2c3e50;
  }
  pre {
    background-color: #272822;
    color: #f8f8f2;
    padding: 15px;
    border-radius: 5px;
    overflow-x: auto;
  }
  code {
    font-family: Consolas, monospace;
    font-size: 14px;
  }
  section {
    margin-bottom: 40px;
  }
</style>
</head>
<body>

<h1>R Code Summary</h1>

<section>
  <h2>Setup</h2>
  <pre><code>knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(neuralnet)
library(NeuralNetTools)
library(e1071)
library(hrbrthemes)
library(MASS)
library(lattice)
set.seed(123)
  </code></pre>
</section>

<section>
  <h2>Q1. SVM on mtcars</h2>

  <h3>(i) Description and Structure</h3>
  <pre><code>desc &lt;- "The 'mtcars' dataset comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973â€“74 models)."
cat(desc)
str(mtcars)
  </code></pre>

  <h3>(ii) Train-Test Split</h3>
  <pre><code>sample_index &lt;- sample(seq_len(nrow(mtcars)), size = 0.7 * nrow(mtcars))
train_data &lt;- mtcars[sample_index, ]
test_data &lt;- mtcars[-sample_index, ]
  </code></pre>

  <h3>(iii) Fit SVM Models</h3>
  <pre><code>svm_radial &lt;- svm(mpg ~ ., data = train_data, kernel = "radial")
summary(svm_radial)

svm_poly &lt;- svm(mpg ~ ., data = train_data, kernel = "polynomial")
summary(svm_poly)
  </code></pre>

  <h3>(iv) Predictions</h3>
  <pre><code>pred_radial &lt;- predict(svm_radial, test_data)
pred_poly &lt;- predict(svm_poly, test_data)
  </code></pre>

  <h3>(v) RMSE Evaluation</h3>
  <pre><code>rmse &lt;- function(actual, predicted) {
  sqrt(mean((actual - predicted)^2))
}
rmse_radial &lt;- rmse(test_data$mpg, pred_radial)
rmse_poly &lt;- rmse(test_data$mpg, pred_poly)

rmse_radial
rmse_poly
  </code></pre>
</section>

<section>
  <h2>Q2. Generalized Linear Models (GLM)</h2>

  <h3>(i) Fit GLM1</h3>
  <pre><code>glm1 &lt;- glm(vs ~ mpg + wt + hp, data = train_data, family = binomial)
summary(glm1)
  </code></pre>

  <h3>(ii) Predictions and Accuracy (GLM1)</h3>
  <pre><code>pred1_prob &lt;- predict(glm1, newdata = test_data, type = "response")
pred1_class &lt;- ifelse(pred1_prob &gt; 0.5, 1, 0)
accuracy1 &lt;- mean(pred1_class == test_data$vs)
accuracy1
  </code></pre>

  <h3>(iii) Fit GLM2 with cyl and drat</h3>
  <pre><code>glm2 &lt;- glm(vs ~ mpg + wt + hp + cyl + drat, data = train_data, family = binomial)
summary(glm2)
  </code></pre>

  <h3>(iv) Predictions and Accuracy (GLM2)</h3>
  <pre><code>pred2_prob &lt;- predict(glm2, newdata = test_data, type = "response")
pred2_class &lt;- ifelse(pred2_prob &gt; 0.5, 1, 0)
accuracy2 &lt;- mean(pred2_class == test_data$vs)
accuracy2
  </code></pre>

  <h3>(v) Compare AICs</h3>
  <pre><code>AIC(glm1)
AIC(glm2)
  </code></pre>

  <h3>(vi) Overfitting Check</h3>
  <pre><code>train_accuracy1 &lt;- mean(ifelse(predict(glm1, train_data, type = "response") &gt; 0.5, 1, 0) == train_data$vs)
train_accuracy2 &lt;- mean(ifelse(predict(glm2, train_data, type = "response") &gt; 0.5, 1, 0) == train_data$vs)

data.frame(Model = c("GLM1", "GLM2"),
           TrainAccuracy = c(train_accuracy1, train_accuracy2),
           TestAccuracy = c(accuracy1, accuracy2))
  </code></pre>

  <h3>(vii) Regression Line for mpg vs wt</h3>
  <pre><code>ggplot(train_data, aes(x = wt, y = mpg)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE, color = "blue") +
  theme_classic() +
  ggtitle("Linear Regression of mpg vs wt")
  </code></pre>
</section>

<section>
  <h2>Q3. ANOVA on PlantGrowth</h2>

  <h3>(i) Structure, Summary, Median</h3>
  <pre><code>data("PlantGrowth")
str(PlantGrowth)
summary(PlantGrowth)
median(PlantGrowth$weight)
  </code></pre>

  <h3>(ii) ANOVA</h3>
  <pre><code>anova_model &lt;- aov(weight ~ group, data = PlantGrowth)
summary(anova_model)
  </code></pre>

  <h3>(iii) p-value</h3>
  <pre><code>summary(anova_model)[[1]]$'Pr(>F)'[1]
  </code></pre>

  <h3>(iv) Histogram with Density Curve</h3>
  <pre><code>ggplot(PlantGrowth, aes(x = weight)) +
  geom_histogram(aes(y = ..density..),
                 binwidth = 0.2,
                 fill = "lightblue", 
                 color = "red") +
  geom_density(color = "red") +
  theme_classic() +
  ggtitle("Histogram and Density Curve of Plant Weights")
  </code></pre>
</section>

<section>
  <h2>Q4. ANN on rock Dataset</h2>

  <h3>(i) Structure and Summary</h3>
  <pre><code>data("rock")
str(rock)
summary(rock)
  </code></pre>

  <h3>(ii) Normalize</h3>
  <pre><code>normalize &lt;- function(x) {
  (x - min(x)) / (max(x) - min(x))
}
rock_norm &lt;- as.data.frame(lapply(rock, normalize))
summary(rock_norm)
  </code></pre>

  <h3>(iii) Split Data</h3>
  <pre><code>set.seed(123)
sample_index &lt;- sample(seq_len(nrow(rock_norm)), size = 0.7 * nrow(rock_norm))
train_rock &lt;- rock_norm[sample_index, ]
test_rock &lt;- rock_norm[-sample_index, ]
  </code></pre>

  <h3>(iv) Fit ANN Model</h3>
  <pre><code>features &lt;- names(train_rock)[names(train_rock) != "perm"]
formula &lt;- as.formula(paste("perm ~", paste(features, collapse = " + ")))

ann_model &lt;- neuralnet(formula, data = train_rock, hidden = c(5), linear.output = TRUE)
plotnet(ann_model)
  </code></pre>

  <h3>(v) Predictions and RMSE</h3>
  <pre><code>pred_ann &lt;- compute(ann_model, test_rock[, features])
predicted_values &lt;- pred_ann$net.result
actual_values &lt;- test_rock$perm
rmse_ann &lt;- rmse(actual_values, predicted_values)
rmse_ann
  </code></pre>
</section>

<section>
  <h2>Q5. Factorial Function</h2>

  <h3>(i) Factorial using Loop</h3>
  <pre><code>factorial_loop &lt;- function(n) {
  result &lt;- 1
  for (i in 1:n) {
    result &lt;- result * i
  }
  return(result)
}

# (ii) Factorial of 8
factorial_loop(8)
  </code></pre>
</section>

</body>
</html>
